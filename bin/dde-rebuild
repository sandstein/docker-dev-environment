#!/usr/bin/env bash

MY_PATH=`dirname $(readlink -f "$0")`
set -a
. $MY_PATH/dde-defines
set +a

if [[ -n ${DOCKER_CONTAINER} ]]; then
   docker-compose -f ${DOCKER_DEV_ENVIRONMENT_HOME}/docker-compose.yml down
   while IFS=',' read -ra CONTAINER; do
      for container in "${CONTAINER[@]}"; do
          touchConfigFile ${container}
          docker-compose -f ${DOCKER_DEV_ENVIRONMENT_HOME}/docker-compose.yml up --build -d ${container}
      done
   done <<< "${DOCKER_CONTAINER}"
   if [[ -n ${PHP_CLI_CONTAINER} ]]; then
       docker-compose -f ${DOCKER_DEV_ENVIRONMENT_HOME}/docker-compose.yml build ${PHP_CLI_CONTAINER}
   fi
else
    echo "No containers given, please add something to \$DOCKER_CONTAINER"
fi
