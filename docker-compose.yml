version: '3'

networks:
  app-tier:
    driver: bridge

services:

  mysql-55:
    container_name: mysql-55
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mysql-55/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mysql-55
    ports:
      - 3355:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mysql-55:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mysql-55/etc:/etc/mysql/conf.d

  mysql-56:
    container_name: mysql-56
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mysql-56/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mysql-56
    ports:
      - 3356:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mysql-56:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mysql-56/etc:/etc/mysql/conf.d

  mysql-57:
    container_name: mysql-57
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mysql-57/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mysql-57
    ports:
      - 3357:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mysql-57:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mysql-57/etc:/etc/mysql/conf.d

  mysql-80:
    container_name: mysql-80
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mysql-80/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mysql-80
    ports:
      - 3380:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mysql-80:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mysql-80/etc:/etc/mysql/conf.d
    command: mysqld --default-authentication-plugin=mysql_native_password --skip-mysqlx

  percona-57:
    container_name: percona-57
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/percona-57/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - percona-57
    ports:
      - 3457:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/percona-57:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/percona-57/etc:/etc/mysql/conf.d

  percona-80:
    container_name: percona-80
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/percona-80/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - percona-80
    ports:
      - 3480:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/percona-80:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/percona-80/etc:/etc/mysql/conf.d
    command: mysqld --default-authentication-plugin=mysql_native_password --skip-mysqlx

  mariadb-55:
    container_name: mariadb-55
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mariadb-55/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mariadb-55
    ports:
      - 3555:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mariadb-55:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mariadb-55/etc:/etc/mysql/conf.d

  mariadb-100:
    container_name: mariadb-100
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mariadb-100/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mariadb-100
    ports:
      - 3500:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mariadb-100:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mariadb-100/etc:/etc/mysql/conf.d

  mariadb-101:
    container_name: mariadb-101
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mariadb-101/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mariadb-101
    ports:
      - 3501:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mariadb-101:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mariadb-100/etc:/etc/mysql/conf.d

  mariadb-102:
    container_name: mariadb-102
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mariadb-102/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mariadb-102
    ports:
      - 3502:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mariadb-102:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mariadb-100/etc:/etc/mysql/conf.d

  mariadb-103:
    container_name: mariadb-103
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mariadb-103/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mariadb-103
    ports:
      - 3503:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mariadb-103:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mariadb-100/etc:/etc/mysql/conf.d

  mariadb-104:
    container_name: mariadb-104
    env_file: env/db.env
    build:
      context: .
      dockerfile: docker/mariadb-104/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - mariadb-104
    ports:
      - 3504:3306
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/mariadb-104:/var/lib/mysql
      - ${DOCKER_VOLUME_BASE_PATH}/config/mariadb-100/etc:/etc/mysql/conf.d

  php-fpm-56:
    container_name: php-fpm-56
    build:
      context: .
      dockerfile: docker/php-fpm-56/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES}
    networks:
      app-tier:
        aliases:
          - php-fpm-56
    ports:
      - 9056:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-56/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-70:
    container_name: php-fpm-70
    build:
      context: .
      dockerfile: docker/php-fpm-70/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES}
    networks:
      app-tier:
        aliases:
          - php-fpm-70
    ports:
      - 9070:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-70/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-71:
    container_name: php-fpm-71
    build:
      context: .
      dockerfile: docker/php-fpm-71/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES}
    networks:
      app-tier:
        aliases:
          - php-fpm-71
    ports:
      - 9071:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-71/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-72:
    container_name: php-fpm-72
    build:
      context: .
      dockerfile: docker/php-fpm-72/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES}
    networks:
      app-tier:
        aliases:
          - php-fpm-72
    ports:
      - 9072:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-72/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-73:
    container_name: php-fpm-73
    build:
      context: .
      dockerfile: docker/php-fpm-73/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES}
    networks:
      app-tier:
        aliases:
          - php-fpm-73
    ports:
      - 9073:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-73/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-74:
    container_name: php-fpm-74
    build:
      context: .
      dockerfile: docker/php-fpm-74/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES}
    networks:
      app-tier:
        aliases:
          - php-fpm-74
    ports:
      - 9074:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-74/etc/php.ini:/usr/local/etc/php/php.ini

  php-cli-56:
    container_name: php-cli-56
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-56/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES}
    networks:
      app-tier:
        aliases:
          - php-cli-56
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-56/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-70:
    container_name: php-cli-70
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-70/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES}
    networks:
      app-tier:
        aliases:
          - php-cli-70
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-70/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-71:
    container_name: php-cli-71
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-71/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES}
    networks:
      app-tier:
        aliases:
          - php-cli-71
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-71/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-72:
    container_name: php-cli-72
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-72/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES}
    networks:
      app-tier:
        aliases:
          - php-cli-72
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-72/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-73:
    container_name: php-cli-73
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-73/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES}
    networks:
      app-tier:
        aliases:
          - php-cli-73
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-73/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-74:
    container_name: php-cli-74
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-74/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES}
    networks:
      app-tier:
        aliases:
          - php-cli-74
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-74/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-fpm-56-x:
    container_name: php-fpm-56-x
    build:
      context: .
      dockerfile: docker/php-fpm-56/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-fpm-56-x
    ports:
      - 9156:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-56/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-70-x:
    container_name: php-fpm-70-x
    build:
      context: .
      dockerfile: docker/php-fpm-70/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-fpm-70-x
    ports:
      - 9170:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-70/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-71-x:
    container_name: php-fpm-71-x
    build:
      context: .
      dockerfile: docker/php-fpm-71/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-fpm-71-x
    ports:
      - 9171:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-71/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-72-x:
    container_name: php-fpm-72-x
    build:
      context: .
      dockerfile: docker/php-fpm-72/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-fpm-72-x
    ports:
      - 9172:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-72/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-73-x:
    container_name: php-fpm-73-x
    build:
      context: .
      dockerfile: docker/php-fpm-73/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-fpm-73
    ports:
      - 9173:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-73/etc/php.ini:/usr/local/etc/php/php.ini

  php-fpm-74-x:
    container_name: php-fpm-74-x
    build:
      context: .
      dockerfile: docker/php-fpm-74/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_FPM_MODULES=${DISABLED_PHP_FPM_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-fpm-74
    ports:
      - 9173:9000
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-fpm-74/etc/php.ini:/usr/local/etc/php/php.ini

  php-cli-56-x:
    container_name: php-cli-56-x
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-56/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-cli-56-x
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-56/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-70-x:
    container_name: php-cli-70-x
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-70/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-cli-70-x
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-70/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-71-x:
    container_name: php-cli-71-x
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-71/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-cli-71-x
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-71/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-72-x:
    container_name: php-cli-72-x
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-72/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-cli-72-x
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-72/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-73-x:
    container_name: php-cli-73-x
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-73/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-cli-73-x
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-73/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  php-cli-74-x:
    container_name: php-cli-74-x
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/php-cli-74/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
        - DISABLED_PHP_CLI_MODULES=${DISABLED_PHP_CLI_MODULES_X}
    networks:
      app-tier:
        aliases:
          - php-cli-74-x
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/php-cli-74/etc/php.ini:/usr/local/etc/php/php.ini
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $CONFIG_BASE:/home/phpcli/.config
      - $SSH_BASE:/home/phpcli/.ssh

  ssh:
    container_name: ssh
    environment:
      - SSH_AUTH_SOCK=$SSH_AUTH_SOCK
    build:
      context: .
      dockerfile: docker/ssh/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - ssh
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/config/ssh/tunnel.conf:/home/ssh/tunnel.conf
      - $SSH_AUTH_SOCK:$SSH_AUTH_SOCK
      - $SSH_BASE:/home/ssh/.ssh

  solr-771:
    container_name: solr-771
    build:
      context: .
      dockerfile: docker/solr-771/Dockerfile
    networks:
      app-tier:
        aliases:
          - solr-771
    ports:
      - 8983:8983
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts
      - ${DOCKER_VOLUME_BASE_PATH}/data/solr-771:/bitnami/solr/data
      - ${DOCKER_VOLUME_BASE_PATH}/solr-771-lib:/var/www/solr/lib

  tomcat-9:
    container_name: tomcat-9
    build:
      context: .
      dockerfile: docker/tomcat-9/Dockerfile
    networks:
      app-tier:
        aliases:
          - tomcat-9
    ports:
      - 8888:8080
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/tomcat-9:/bitnami
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts

  apache-24:
    container_name: apache-24
    build:
      context: .
      dockerfile: docker/apache-24/Dockerfile
      args:
        - USER_ID=${USER_ID}
        - GROUP_ID=${GROUP_ID}
    networks:
      app-tier:
        aliases:
          - apache-24
    ports:
      - ${APACHE_HTTP_PORT}:80
      - ${APACHE_HTTPS_PORT}:443
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/config/apache-24/conf.d:/usr/local/apache2/conf/conf.d:ro
      - ${DOCKER_VOLUME_BASE_PATH}/vhosts:/var/www/vhosts

  redis-5:
    container_name: redis-5
    build:
      context: .
      dockerfile: docker/redis-5/Dockerfile
    networks:
      app-tier:
        aliases:
          - redis-5
    ports:
      - 6379:6379

  mailhog:
    container_name: mailhog
    build:
      context: .
      dockerfile: docker/mailhog/Dockerfile
    networks:
      app-tier:
        aliases:
          - mailhog
    ports:
      - 1025:1025
      - 8025:8025

  varnish:
    container_name: varnish
    env_file: env/varnish.env
    build:
      context: .
      dockerfile: docker/varnish/Dockerfile
    networks:
      app-tier:
        aliases:
          - varnish
    ports:
      - ${VARNISH_HTTP_PORT}:80
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/config/varnish/etc/varnish:/etc/varnish

  elastic-56:
    container_name: elastic-56
    build:
      context: .
      dockerfile: docker/elastic-56/Dockerfile
    networks:
      app-tier:
        aliases:
          - elastic-56
    env_file: env/elastic.env
    ports:
      - 9256:9200
      - 9356:9300
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/elastic-56:/usr/share/elasticsearch/data

  elastic-64:
    container_name: elastic-64
    build:
      context: .
      dockerfile: docker/elastic-64/Dockerfile
    networks:
      app-tier:
        aliases:
          - elastic-64
    env_file: env/elastic.env
    ports:
      - 9264:9200
      - 9364:9300
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/elastic-64:/usr/share/elasticsearch/data

  elastic-71:
    container_name: elastic-71
    build:
      context: .
      dockerfile: docker/elastic-71/Dockerfile
    networks:
      app-tier:
        aliases:
          - elastic-71
    env_file: env/elastic.env
    ports:
      - 9271:9200
      - 9371:9300
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/elastic-71:/usr/share/elasticsearch/data

  elastic-73:
    container_name: elastic-73
    build:
      context: .
      dockerfile: docker/elastic-73/Dockerfile
    networks:
      app-tier:
        aliases:
          - elastic-73
    env_file: env/elastic.env
    ports:
      - 9273:9200
      - 9373:9300
    volumes:
      - ${DOCKER_VOLUME_BASE_PATH}/data/elastic-73:/usr/share/elasticsearch/data

